{% extends "layout/default.html" %}
{% block title %}
	Calendrier
{% endblock %}
{% block page_title %}
	Calendrier
{% endblock %}
{% block page_subtitle %}
	{% with first_day_data=hours_data.0.lines.0.days|first last_day_data=hours_data.0.lines.0.days|last %}
		Du {{first_day_data.day|date:"d/m/Y"}} au {{last_day_data.day|date:"d/m/Y"}}
	{% endwith %}
{% endblock %}
{% block menu_link_calendar %}current-menu-item{% endblock %}
{% block page_link %}
	Calendrier
{% endblock %}
{% block content %}
	{% if telefab_open %}
		<p>
			La salle de Brest du Téléfab est actuellement <span class="place_open">ouverte</span>.
		</p>
	{% endif %}
	<div class="pager">
		<p class="next">
			{% if time_position == "past" %}
				<a href="{% url main.views.show_events %}">Semaine actuelle &raquo;</a>
			{% endif %}
			<a href="{% url main.views.show_events year=next_date.year month=next_date.month day=next_date.day %}">Semaine suivante &raquo;</a>
		</p>
		<p class="previous">
			<a href="{% url main.views.show_events year=previous_date.year month=previous_date.month day=previous_date.day %}">&laquo; Semaine précédente</a>
			{% if time_position == "future" %}
				<a href="{% url main.views.show_events %}">&laquo; Semaine actuelle</a>
			{% endif %}
		</p>
	</div>
	<table class="calendar">
		<!-- Days list -->
		<tr class="days">
			<th class="hours links"><a href="{% url main.views.ical_events %}" title="Utilisez ce lien iCal pour importer ce calendrier">iCal</a></th>
			{% for day_data in hours_data.0.lines.0.days %}
				<th{% if day_data.current %} class="current"{% endif %}>
					<span class="day">{{ day_data.day|date:"l"|capfirst }}</span>
					{{ day_data.day|date:"j F" }}
				</th>
			{% endfor %}
		</tr>
		<!-- Hours list -->
		{% for hour_data in hours_data %}
			<!-- n lines per hour -->
			{% for line_data in hour_data.lines %}
				<tr class="line{% if forloop.first %} firstline{% endif %}{% if forloop.last %} lastline{% endif %}">
					<!-- Hour title -->
					{% if forloop.first %}
						<th class="hour">
							<span>{{ hour_data.hour }}</span>&nbsp;h
						</th>
					{% else %}
						<th class="hour">&nbsp;</th>
					{% endif %}
					<!-- One cell per day -->
					{% for day_data in line_data.days %}
						<td>
								<div class="events_container">
									{% for event_data in day_data.events %}
										<div class="event_zone">
											<div class="event {{event_data.event.category_id}}" style="height: {{event_data.height}}%; top: {{event_data.top}}%; width: {{event_data.width}}%; left: {{event_data.left}}%;">
												<h3>{{event_data.event.global_title}}</h3>
												<h4>De {{event_data.event.start_time|date:"G:i"}} à {{event_data.event.end_time|date:"G:i"}}</h4>
												{% if event_data.event.description %}
													<p>{{event_data.event.description}}</p>
												{% endif %}
												{% if event_data.event.link %}
													<p><a href="{{event_data.event.link }}" target="_blank">
														En savoir plus &raquo;
													</a></p>
												{% endif %}
												{% if event_data.event.animators.count > 0 %}
													<p class="animators"><span>Animateur{{event_data.event.animators.count|pluralize:"s"}} :</span> {{event_data.event.animators_list}}</p>
												{% endif %}
												<p class="location">
													<span>Lieu :</span> {{event_data.event.location}}
												</p>
											</div>
											<!-- Tooltip with all info about the event -->
											<div class="tooltip">
												<h3>{{event_data.event.global_title}}</h3>
												<h4>De {{event_data.event.start_time|date:"G:i"}} à {{event_data.event.end_time|date:"G:i"}}</h4>
												{% if event_data.event.description %}
													<p>{{event_data.event.description}}</p>
												{% endif %}
												{% if event_data.event.link %}
													<p><a href="{{event_data.event.link }}" target="_blank">
														En savoir plus &raquo;
													</a></p>
												{% endif %}
												{% if event_data.event.animators.count > 0 %}
													<p class="animators"><span>Animateur{{event_data.event.animators.count|pluralize:"s"}} :</span> {{event_data.event.animators_list}}</p>
												{% endif %}
												<p class="location">
													<span>Lieu :</span> {{event_data.event.location}}
												</p>
											</div>
										</div>
									{% endfor %}
								</div>
						</td>
					{% endfor %}
				</tr>
			{% endfor %}
			
		{% endfor %}
	</table>
{% endblock %}